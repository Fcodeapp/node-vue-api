import{r as x,a as E,b as u,o as i,c as g,e as v,f as d,w as m,i as D,m as k,j as H,E as M,g as L,F as R,h as U,t as C}from"./index-bac9a75a.js";import{_ as Y}from"./Pagination-9c7ed825.js";const q=l=>({year:l.getFullYear(),month:l.getMonth(),date:l.getDate(),hour:l.getHours(),min:l.getMinutes(),sec:l.getSeconds(),msec:l.getMilliseconds(),day:l.getDay()}),A={class:"container mx-auto my-5 p-5"},G={class:"py-3 flex justify-between"},I=v("span",{class:"pr-3 pl-1 text-sm"},"查詢日期區間",-1),J={key:0,class:"text-red-500"},K={key:1,class:"text-green-500"},O={key:2},X={__name:"FundList",setup(l){const h=x([new Date,new Date]),_=x([]);let c=[],S=[];const F=e=>{if(!e){y();return}const n=h.value[0],o=h.value[1];c=S.filter(t=>{const p=new Date(t.date).getTime();return p>=n&&p<=o}),V()},z=x(!1),r=x({currentPage:1,total:1,pageSize:5,pageSizes:[5,10,20,50],layout:"total, sizes, prev, pager, next, jumper"}),$=()=>{const e=c.filter((n,o)=>o<r.value.pageSize);_.value=e},V=()=>{r.value.total=c.length,$(),z.value=!0},P=e=>{r.value.currentPage=1,r.value.pageSize=e,$()},T=e=>{let n=r.value.pageSize*(e-1),o=r.value.pageSize*e,s=[];for(let t=n;t<o;t++)c[t]&&s.push(c[t]);_.value=s,r.value.currentPage=e},j=E([{prop:"date",label:"交易時間",width:100,fexid:!0,align:"center"},{prop:"type",label:"類別",width:120,fexid:!1,align:"center"},{prop:"income",label:"收入",width:100,fexid:!1,align:"right"},{prop:"expend",label:"支出",width:100,fexid:!1,align:"right"},{prop:"remark",label:"備註",width:"auto",fexid:!1,align:"center"},{prop:"cash",label:"餘額",width:120,fexid:!1,align:"right"}]),y=()=>{H.get("/api/profiles").then(e=>{console.log(e),e.data.msg?M.error(`資料取得失敗！ ${e.data.msg}`):(c=e.data,S=e.data,V())}).catch(e=>{console.log(e),M.error(`錯誤！ ${e.message}`)})},B=()=>{console.log("click more")},N=e=>{const n=q(new Date(e)),{year:o,month:s,date:t,hour:f,min:p,sec:b}=n;return`${o}-${s}-${t} ${f}:${p}:${b}`};return y(),(e,n)=>{var b;const o=u("el-date-picker"),s=u("el-button"),t=u("el-table-column"),f=u("el-tooltip"),p=u("el-table");return i(),g("main",A,[v("div",G,[v("div",null,[I,d(o,{modelValue:h.value,"onUpdate:modelValue":n[0]||(n[0]=a=>h.value=a),onChange:F,type:"daterange","range-separator":"~","start-placeholder":"開始日期","end-placeholder":"結束日期",size:"large"},null,8,["modelValue"])]),v("div",null,[d(s,{icon:"Refresh",onClick:y},{default:m(()=>[L("更新")]),_:1})])]),((b=_.value)==null?void 0:b.length)>0?(i(),D(p,{key:0,stripe:"",data:_.value},{default:m(()=>[d(t,{type:"index",label:""}),(i(!0),g(R,null,U(j,a=>(i(),D(t,{key:a.prop,fixed:a.fixed,prop:a.prop,label:a.label,width:a.width,align:a.align},{default:m(w=>[a.prop==="expend"?(i(),g("span",J,"-"+C(w.row.expend),1)):a.prop==="income"?(i(),g("span",K,"+"+C(w.row.income),1)):a.prop==="date"?(i(),g("span",O,C(N(w.row.date)),1)):k("",!0)]),_:2},1032,["fixed","prop","label","width","align"]))),128)),d(t,{fixed:"right",label:"功能",width:"130",align:"center"},{default:m(()=>[d(f,{content:"查看明細",placement:"top"},{default:m(()=>[d(s,{type:"primary",icon:"MoreFilled",circle:"",onClick:B})]),_:1})]),_:1})]),_:1},8,["data"])):k("",!0),z.value?(i(),D(Y,{key:1,pagination:r.value,onSizeChange:P,onCurrentChange:T},null,8,["pagination"])):k("",!0)])}}};export{X as default};
